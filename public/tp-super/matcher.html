<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SuperPower Matcher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/axios@latest"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="navbar_placeholder"></div>
    <main class="container my-4" id="matcherApp">
      <h1 class="my-4">SuperPower Matcher</h1>
      <p>Sélectionnez des seuils (0-100) pour les pouvoirs souhaités. Les héros qui ont >= seuil seront retournés.</p>

      <div class="row g-3">
        <div class="col-md-4" v-for="(label, key) in labels" :key="key">
          <label class="form-label">{{ label }}: {{ thresholds[key] }}</label>
          <input type="range" class="form-range" min="0" max="100" v-model.number="thresholds[key]">
        </div>
      </div>

      <div class="mt-3">
        <button class="btn btn-primary" @click="match">Rechercher</button>
        <button class="btn btn-secondary ms-2" @click="reset">Réinitialiser</button>
    

      <h2 class="mt-4">Résultats</h2>
      <ul class="list-group">
        <li class="list-group-item" v-for="h in results" :key="h.id">
            <img :src="h.images?.sm" width="40" class="rounded-circle me-2"> <a :href="`detail.html?id=${h.id}`">{{ h.name }} </a> — <small class="text-muted">ID {{ h.id }}</small>
          
        </li>
      </ul>
    </main>

    <script>
    fetch('navbar.html').then(r=>r.text()).then(html=>document.getElementById('navbar_placeholder').innerHTML = html).catch(()=>{});
    const { createApp } = Vue;
    createApp({
      data() { return {
        heroes: [],
        thresholds: { intelligence: 50, strength: 50, speed: 50, durability: 50, power: 50, combat: 50 },
        labels: { intelligence: 'Intelligence', strength: 'Force', speed: 'Vitesse', durability: 'Durabilité', power: 'Puissance', combat: 'Combat' },
        results: []
      }; },
      mounted() {
        axios.get('https://cdn.jsdelivr.net/gh/rtomczak/superhero-api@0.3.0/api/all.json')
          .then(r=>{ this.heroes = r.data; })
          .catch(e=>console.error(e));
      },
      methods: {
        match() {
          this.results = this.heroes.filter(h => {
            const p = h.powerstats || {};
            return Object.keys(this.thresholds).every(k => (Number(p[k]) || 0) >= this.thresholds[k]);
          });
        },
        reset() { this.thresholds = { intelligence: 50, strength: 50, speed: 50, durability: 50, power: 50, combat: 50 }; this.results = []; }
      }
    }).mount('#matcherApp');
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
